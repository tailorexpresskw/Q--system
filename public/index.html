<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Q System</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body data-view="dashboard">
  <div class="ambient-sheen"></div>
  <div class="staff-lock" id="staffLock">
    <div class="staff-lock-card">
      <div class="brand-mark">Q</div>
      <h2 data-i18n="lock.title">Staff access</h2>
      <p class="muted" data-i18n="lock.subtitle">Enter the password to open the dashboard.</p>
      <div class="lock-row">
        <input id="staffLockInput" type="password" placeholder="Enter password" data-i18n-placeholder="lock.placeholder" />
        <button class="btn primary" id="staffLockButton" data-i18n="lock.unlock">Unlock</button>
      </div>
      <div class="muted small" id="staffLockStatus"></div>
    </div>
  </div>
  <header class="site-header">
    <div class="brand">
      <div class="brand-mark">Q</div>
      <div>
        <h1 data-i18n="app.title">Q System</h1>
        <p class="subtitle" data-i18n="brand.subtitle">Live queue control with realtime sync.</p>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn ghost" id="copyCheckinHeader" data-i18n="header.copyCheckin">Copy check-in link</button>
      <a class="btn primary" id="openCheckinHeader" href="?checkin=1" data-i18n="header.openCheckin">Open check-in</a>
      <div class="lang-switch">
        <span class="muted small" data-i18n="language.label">Language</span>
        <select id="languageSelect" aria-label="Language">
          <option value="en" data-i18n="language.english">English</option>
          <option value="ar" data-i18n="language.arabic">Arabic</option>
        </select>
      </div>
    </div>
  </header>

  <main>
    <section id="dashboardView" class="view dashboard">
      <section class="metrics">
        <div class="metric">
          <span class="label" data-i18n="metrics.active">Active in queue</span>
          <span class="value" id="metricActive">0</span>
        </div>
        <div class="metric">
          <span class="label" data-i18n="metrics.totalWait">Estimated total wait</span>
          <span class="value" id="metricTotalWait">0 min</span>
        </div>
        <div class="metric">
          <span class="label" data-i18n="metrics.avgService">Average service time</span>
          <span class="value" id="metricAvgService">0 min</span>
        </div>
        <div class="metric">
          <span class="label" data-i18n="metrics.lastCheckin">Last check-in</span>
          <span class="value" id="metricLastCheckin">—</span>
        </div>
      </section>

      <section class="dashboard-grid">
        <section class="panel queue-panel">
          <div class="panel-header">
            <div>
              <h2 data-i18n="queue.title">Live Queue</h2>
              <p class="muted" data-i18n="queue.subtitle">ETAs are driven by service averages and queue order.</p>
            </div>
            <div class="panel-actions">
              <button class="btn ghost" id="refreshQueue" data-i18n="queue.refresh">Refresh</button>
              <button class="btn primary" id="exportCsv" data-i18n="queue.exportCsv">Export CSV</button>
            </div>
          </div>

          <div class="queue-highlight">
            <div>
              <span class="label" data-i18n="queue.nowServing">Now serving</span>
              <span class="value" id="nowServing">—</span>
            </div>
            <div>
              <span class="label" data-i18n="queue.nextUp">Next up</span>
              <span class="value" id="nextUp">—</span>
            </div>
            <div>
              <span class="label" data-i18n="queue.projectedFinish">Projected finish</span>
              <span class="value" id="projectedFinish">—</span>
            </div>
          </div>

          <div class="table-wrap">
            <table id="queueTable">
              <thead>
                <tr>
                  <th data-i18n="table.number">#</th>
                  <th data-i18n="table.name">Name</th>
                  <th data-i18n="table.phone">Phone</th>
                  <th data-i18n="table.status">Status</th>
                  <th data-i18n="table.wait">Wait</th>
                  <th data-i18n="table.eta">ETA</th>
                  <th data-i18n="table.actions">Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section class="panel share-panel">
          <div class="panel-header">
            <div>
              <h2 data-i18n="share.title">Public Check-In</h2>
              <p class="muted" data-i18n="share.subtitle">Share this link or QR code to accept arrivals.</p>
            </div>
          </div>
          <div class="share-link">
            <input id="checkinLink" type="text" readonly />
            <button class="btn primary" id="copyCheckin" data-i18n="share.copy">Copy link</button>
          </div>
          <div class="qr-wrap">
            <img id="qrImage" alt="QR code for check-in link" data-i18n-alt="share.qrAlt" />
            <p class="muted small" data-i18n="share.qrNote">QR code generated from the current check-in URL.</p>
          </div>
          <div class="note">
            <span data-i18n="share.dataNote">Data is synced via the backend database.</span>
          </div>
          <div class="branch-box">
            <h3 data-i18n="branches.title">Branches</h3>
            <p class="muted small" data-i18n="branches.subtitle">Select a branch to view its queue or create a new one.</p>
            <div class="branch-row">
              <select id="branchSelect" aria-label="Branch"></select>
              <button class="btn ghost" id="createBranch" data-i18n="branches.create">Create</button>
            </div>
            <div class="branch-meta muted small" id="branchMeta"></div>
          </div>
          <div class="pin-box">
            <h3 data-i18n="pin.title">Staff PIN</h3>
            <p class="muted small" data-i18n="pin.subtitle">Required for staff actions like notify, serve, cancel, and service edits.</p>
            <div class="pin-row">
              <input id="staffPinInput" type="password" placeholder="Enter PIN" data-i18n-placeholder="pin.placeholder" />
              <button class="btn ghost" id="saveStaffPin" data-i18n="pin.save">Save</button>
            </div>
            <div class="pin-status muted small" id="staffPinStatus"></div>
          </div>
        </section>

      </section>
    </section>

    <section id="checkinView" class="view checkin">
      <div class="checkin-layout">
        <div class="checkin-card">
          <div class="checkin-header">
            <span class="chip" data-i18n="checkin.chip">Public check-in</span>
            <h2 data-i18n="checkin.title">Join the queue</h2>
            <p class="muted" data-i18n="checkin.subtitle">Enter your details to reserve your spot.</p>
          </div>
          <div class="ticket-display" id="ticketDisplay">
            <span class="label" data-i18n="ticket.label">Your number</span>
            <div class="ticket-number" id="ticketNumberDisplay">Q-0</div>
            <p class="muted small" data-i18n="ticket.note">Keep this number. It will stay on your screen.</p>
          </div>
          <form id="checkinForm">
            <label>
              <span data-i18n="checkin.nameLabel">Full name</span>
              <input id="checkinName" name="name" type="text" placeholder="Alex Johnson" data-i18n-placeholder="checkin.namePlaceholder" />
            </label>
            <label>
              <span data-i18n="checkin.phoneLabel">Phone</span>
              <input id="checkinPhone" name="phone" type="tel" placeholder="(555) 555-0199" data-i18n-placeholder="checkin.phonePlaceholder" />
            </label>
            <div class="checkin-actions">
              <button class="btn primary" type="submit" data-i18n="checkin.submit">Check in</button>
              <button class="btn ghost" type="button" id="quickCheckin" data-i18n="checkin.quick">Take number</button>
            </div>
          </form>
          <div id="checkinStatus" class="checkin-status"></div>
        </div>
        <div class="checkin-info">
          <a class="btn ghost" href="./" data-i18n="help.backToStaff">Staff dashboard</a>
        </div>
      </div>
    </section>

    <section id="displayView" class="view display">
      <div class="display-board">
        <div class="display-card current">
          <span class="label" data-i18n="display.nowServing">Now serving</span>
          <div class="display-number" id="displayNow">Q-0</div>
        </div>
        <div class="display-card next">
          <span class="label" data-i18n="display.nextUp">Next</span>
          <div class="display-number" id="displayNext">Q-0</div>
        </div>
      </div>
      <div class="display-note muted" data-i18n="display.note">Please wait until your number appears.</div>
    </section>
  </main>

  <footer class="site-footer">
    <span data-i18n="footer.left">Q System · Realtime queue</span>
    <span data-i18n="footer.right">Use ?checkin=1 for the public check-in view.</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>

